(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["MaterialManage"],{"016e":function(t,e,a){},"11c5":function(t,e,a){"use strict";a("5743")},5743:function(t,e,a){},cc38:function(t,e,a){"use strict";a("016e")},f929:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"business-content-container"},[a("div",{staticClass:"business-content-inner"},[a("div",{staticClass:"search-row l-flex-row-start"},[a("el-input",{staticClass:"l-search-input",attrs:{placeholder:"请输入素材标题关键字",clearable:""},model:{value:t.searchKeywords,callback:function(e){t.searchKeywords=e},expression:"searchKeywords"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")]),a("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(e){t.dialogShow=!0}}},[t._v("添加")])],1),a("div",{staticClass:"l-table-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,height:"100%",border:""}},[a("el-table-column",{attrs:{prop:"id",width:"96",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"96",align:"center"}}),a("el-table-column",{attrs:{label:"素材展示",align:"center",width:"280"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-image",{staticClass:"user-table-logo-img",attrs:{fit:"contain",src:t.row.file?t.row.file:"https://","preview-src-list":t.row.file?[t.row.file]:[]}})]}}])}),a("el-table-column",{attrs:{label:"素材标题",align:"center",width:"320"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{staticClass:"url-link"},[t._v(t._s(e.row.file))])]}}])}),a("el-table-column",{attrs:{prop:"title",label:"素材标题",align:"center",width:"180"}}),a("el-table-column",{attrs:{prop:"name",label:"操作",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),t.deleteArticle(e.row)}}},[t._v(" 删除 ")])]}}])})],1)],1),a("div",{staticClass:"l-page-jumper l-flex-row-start"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"hide-on-single-page":!1,"current-page":t.page},on:{"current-change":t.currentPageChange}})],1)]),t.refreshKit?a("el-dialog",{attrs:{title:"添加素材",top:"8vh",visible:t.dialogShow,width:t.isPc?"60%":"96%","append-to-body":!0,"destroy-on-close":"",close:t.onDialogClose},on:{"update:visible":function(e){t.dialogShow=e}}},[t.refreshKit?a("add-material-dialog",{attrs:{closeDialog:t.closeDialog},on:{finish:t.onAddFinish}}):t._e()],1):t._e()],1)},o=[],l=a("365c"),n=a("c698"),s=a("4260"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"l-dialog-content"},[a("div",{staticClass:"l-dialog-row l-flex-row-start"},[a("p",{staticClass:"min-width-text5"},[t._v("素材标题")]),a("el-input",{staticClass:"l-dialog-input",attrs:{placeholder:"素材标题与素材展示无关，仅用于后台标识",clearable:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),a("div",{staticClass:"l-dialog-row l-flex-row-start height-auto"},[a("div",{staticClass:"l-dialog-half-row l-flex-row-start height-auto"},[a("p",{staticClass:"min-width-text5"},[t._v("素材图片")]),a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:t.uploaderFileUrl,"on-success":t.onUploaderSuccess,"on-error":t.onError,"on-progress":t.onProgress,"on-change":t.onFilePickerChange,"show-file-list":!1,data:t.uploaderFileExtraParams}},[t.imageUrl.length?t._e():a("i",{staticClass:"el-icon-upload",staticStyle:{"font-size":"32px"}}),t.imageUrl.length?a("el-image",{staticClass:"after-uploader-img",attrs:{src:t.imageUrl,fit:"contain"}}):a("div",{staticClass:"el-upload__text"},[t._v(" 将图片拖到此处，或"),a("em",[t._v("点击上传")])])],1)],1)]),a("div",{staticClass:"l-dialog-option-footer"},[a("el-button",{on:{click:t.cancelDialog}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:t.addLoading},on:{click:t.confirmAdd}},[t._v("确 认")])],1)])},r=[],d=a("4360"),u={name:"AddMaterialDialog",props:{closeDialog:{type:Function,default:null}},data:function(){return{imageUrl:"",value:!0,disable:1,uploaderFileUrl:"http://101.132.133.126:8091"+n["l"],uploaderFileExtraParams:{token:d["a"].state.user.token},title:"",content:"",linkUrl:"",sort:1,status:"1",status_types:[{value:"1",label:"仅PC"},{value:"2",label:"仅H5"},{value:"3",label:"PC和H5"}],addLoading:!1}},watch:{value:function(t,e){console.log("value改变了",t,e),this.disable=t?1:0}},methods:{cancelDialog:function(){this.closeDialog()},onUploaderSuccess:function(t){200===t.code?(this.imageUrl=t.data.list[0].url,this.$message.success("图片上传成功！")):this.$message.error(t.msg)},onError:function(t){console.log("文件上传失败"),this.$message.error("文件上传失败")},onProgress:function(t){},onFilePickerChange:function(t){},confirmAdd:function(){var t=this;if(Object(s["h"])(this.title))return this.$message.error("请输入素材标题");this.addLoading=!0,console.log(this.content);var e={file:this.imageUrl,title:this.title};console.log("参数",e),l["a"].post(n["b"],e).then((function(e){console.log(e),200==e.code&&(t.$emit("finish"),t.addLoading=!1,t.cancelDialog())})).catch((function(e){t.addLoading=!1,console.log(e)}))}}},g=u,h=(a("11c5"),a("2877")),f=Object(h["a"])(g,c,r,!1,null,"72de167a",null),p=f.exports,w={name:"MaterialManage",components:{"add-material-dialog":p},data:function(){return{isPc:Object(s["i"])(),userName:"",dialogShow:!1,preViewDialogShow:!1,refreshKit:!0,total:0,list:[],page:1,loading:!0,isInSearch:!1,searchKeywords:""}},watch:{dialogShow:function(t,e){var a=this;t||(this.refreshKit=!1,this.$nextTick((function(){a.refreshKit=!0})))},preViewDialogShow:function(t,e){var a=this;t||(this.refreshKit=!1,this.$nextTick((function(){a.refreshKit=!0})))},searchKeywords:function(t,e){0===t.length&&this.isInSearch&&(this.isInSearch=!1,this.getListByPage(1))}},created:function(){this.getListByPage(1)},methods:{currentPageChange:function(t){console.log(t),this.page=t,this.getListByPage(t)},onAddFinish:function(){this.getListByPage(this.page)},getListByPage:function(t){var e=this;this.loading=!0,l["a"].get(n["t"],{params:{page:t}}).then((function(t){console.log(t),e.loading=!1,e.total=t.data.count,e.list=t.data.list})).catch((function(t){e.loading=!1,console.log(t)}))},showPreviewDialog:function(t,e){var a=this;console.log(t),this.preViewDialogShow=!0,this.$nextTick((function(){a.$refs.previewSolutionRef.setContent(t.desc)}))},search:function(){var t=this;this.page=1,this.$nextTick((function(){var e={title:t.searchKeywords,page:t.page};t.loading=!0,l["a"].get(n["t"],{params:e}).then((function(e){console.log(e),t.loading=!1,t.total=e.data.count,t.list=e.data.list,t.isInSearch=!0})).catch((function(e){t.loading=!1,console.log(e)}))}))},showDetailsDialog:function(){},deleteArticle:function(t){var e=this;this.$confirm("此操作将永久删除此项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:t.id};l["a"].post(n["o"],a).then((function(t){200==t.code?(e.$message({type:"success",message:"删除成功!"}),e.onAddFinish()):e.$message({type:"error",message:t.msg})})).catch((function(t){}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},closeDialog:function(){this.dialogShow=!1,this.onDialogClose()},closePreViewDialog:function(t,e){this.preViewDialogShow=!1},onDialogClose:function(){}}},m=w,v=(a("cc38"),Object(h["a"])(m,i,o,!1,null,"a8e44662",null));e["default"]=v.exports}}]);